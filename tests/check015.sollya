/* Set of tests for supnorm */

print("=============== Check Supnorm #1 ================");//passes
p = remez(exp(x), 5, [-1;1]);
midpointmode=on!;
supnorm(p, exp(x), [-1;1], absolute, 2^(-40));

print("=============== Check Supnorm #2 ================");//passes
p = remez(exp(x), 10, [0;1]);
midpointmode=on!;
supnorm(p, exp(x), [0;1], absolute, 2^(-40));

print("=============== Check Supnorm #3 ================");//passes
mode=relative;
theta=1b-135;
d = [-1b-2;1b-2];
f = expm1(x);
p = x * (1 +  x * ( 2097145 * 2^(-22) + x * ( 349527 * 2^(-21) + x * (87609 * 2^(-21) + x * 4369 * 2^(-19))))); 
theta=1b-40;
supnorm(p,f,d,mode,theta);

print("=============== Check Supnorm #4 ================");//passes
mode=relative;
d = [-1b-9;1b-9];
f = log2(1 + x);
p = x * (117045327009867803036301574157545b-106 + x * ((-58522663504933901606981166592605b-106) + x * (8663094464742397b-54 + x * ((-6497320848515433b-54) + x * (2598928339549937b-53 + x * ((-541446114948727b-51) + x * 3712726891772213b-54))))));
theta=1b-205;
supnorm(p,f,d,mode,theta);

print("=============== Check Supnorm #5 ================");//passes
mode=relative;
d = [-205674681606191b-53;205674681606835b-53];
f = asin(x + 0x3fe5e58f08291918);
p = 15651770362713997207607972106972745b-114 + (x *(3476698806776688943652103662933b-101 + (x *(17894972500311187082269807705171b-104 + (x *(126976607296441025269345153102591b-106 + (x *(249107378895562413495151944042799b-106 + (x *(139053951649796304768149995225589b-104 + (x *(165428664168251249501887921888847b-103 + (x *(206167601873884163281098618631159b-102 + (x *(66386611260133347295510390653099b-99 + (x * (2433556521489987b-43 + (x* (409716955440671b-39 + (x * (2242518346998655b-40 + (x *(3108616106416871b-39 + (x * (4356285307071455b-38 + (x *(6161286268548935b-37 + (x * (8783550111623067b-36 + (x *(788026560267325b-31 + (x * (1138037795125313b-30 + (x *(3304615966282565b-30 + (x * (602367826671283b-26 + (x *(1765006192104851b-26 + (x * (1337636086941861b-24 + (x *986777691264547b-22)))))))))))))))))))))))))))))))))))))))))));
theta=1b-60;
prec=400!;
supnorm(p,f,d,mode,theta);

print("=============== Check Supnorm #6 ================"); //passes
mode=relative;
prec=300!;
d = [-1/2;1/4];
f = cos(x);
p = remez(1,15,d,1/f,1e-40); 
prec=default!;
theta=1b-100;
supnorm(p,f,d,mode,theta);

print("=============== Check Supnorm #7 ================");//passes
mode=relative;
prec=400!;
d = [-1/8;1/8];
f = exp(x);
p=1291124939043454294827959586001505937164852896414611756415643039531479680609629260097919725377401206658955423510867812933b-399 + x * (1291124939043454294827959586001505937164852896414611756407759293348856964764186953322986589460672969435069958748491718283b-399 + x * (1291124939043454294827959586001505937164852896414611742842916313201487217248242990712587184030633906090137602556193308777b-400 + x * (1721499918724605726437279448002007916219803861886149410406732804556694110264268799366882772800656159765418763369767923869b-402 + x * (1721499918724605726437279448002007916219803861886928049851542292580594202097368397525596049532723601180890716568841852971b-404 + x * (688599967489842290574911779200803166487921544748146677805317095693650672977111381945276005270502268669363247750562141109b-405 + x * (918133289986456387433215705601070888650562042107828893577378984985802017340780034420418039342182577636371604545753247685b-408 + x * (2098590377111900314133064469945304888344142586006558021664462294500550566006715853849729548335450138563444975611072384915b-412 + x * (2098590377111900314133064469945304888345787506900621321180727067543258071161052823401917797089874824160141551745303600509b-415 + x * (932706834271955695170250875531246617029863789325186530775644670361528998993026253332715955100711707177976542185420125885b-417 + x * (186541366854391139034050175106249317675194606310468992601212125887714941698557011635643430617148947777325881970320599911b-418 + x * (2170663177942005981487129310327265817430136743794322761791212108289168199121016399511022765792217934974290164512400558051b-425 + x * (723554392647335327162376436776575188728320134851889625237160943201761614313054850997686096169392444013734775049800364135b-427 + x * (445264241629129432099923961086461053843117889043738115595645570179588863813466486158437851805221549064027305469772175195b-430 + x * (1017746838009438701942683300338197780799042429908471623542287463474569859335113951279406783547674904661405075222370152653b-435 + x * (271399156802516987184715668022449290765604321334910931946270618816084433310692805993200010568980374341586319016626039405b-437 + x * (2171193254420135897480301350825607712011172107075923446450599655895677713120365969751962821314954760562289074188094789451b-444 + x * (2043476004160127903487494000509588015818708867395743746978714423885089009799059654843663103804548054018562648174876580061b-448 + x * (908211557404501261461971507657492862559270740528797479096948806118152290717219182619080722630251277564118402740142879215b-451 + x * (1529619465102318290396191335466982351668824576419822769979570691542070957164975362583515486255615591549174162951007028183b-456 + x * (1223695572082734528475377304206308178928295327141464300806858140000189195058732384055167155268721672655962320814134386585b-460 + x * (466169741743865438694533850917589402256859012268885527875904121812833883515506233431119922322746057508112973882086354899b-463 + x * (339032535142399295985553596850309623127346596956633233039500677601672953959025144616613616695701925012721839172059538925b-467 + x * (1886789853182169718590609346799899921135706970254622139162686047099233945700405342620686331475908007094622992876398666851b-474 + x * (2516112710027923243369908368888976324181415757063417914589335963128261275982808145367994972728592019136949818934599107321b-479 + x * 1609827695620693077847485865687191912593223271819829393342670614997995102920099238219568170602045477783711943005139617211b-483))))))))))))))))))))))));
prec=300!;
theta=1b-250;
supnorm(p,f,d,mode,theta);

print("=============== Check Supnorm #8 ================");//passes
prec=200!;
d = [-1/2;1/2];
f = sin(x);
p = remez(f,9,d,1,1e-40); 
prec=default!;
mode=absolute;
theta=1b-60;
supnorm(p,f,d,mode,theta);

print("=============== Check Supnorm #9 ================");//passes
prec=200!;
d = [1;2];
f = exp(cos(x)^2 + 1);
p = remez(1,15,d,1/f,1e-40);
theta=1b-60;
prec=default!;
mode=relative;
supnorm(p,f,d,mode,theta);

print("=============== Check Supnorm #10 ================");//passes
prec=200!;
d=[1/4;1/2];
f=tan(x);
p = remez(1,10,d,1/f,1e-40);
prec=default!;
mode=relative;
theta=1b-60;
supnorm(p,f,d,mode,theta);

print("=============== Check Supnorm #11 ================");//passes
d=[1;2];
f=x^2.5;
p=remez(1,7,d,1/f,1e-40);
mode=relative;
theta=1b-35;
supnorm(p,f,d,mode,theta);

print("=============== Check Supnorm #12 ================");//passes
restart;
mode=relative;
d=[-1/8;1/8];
f=sin(x);
print("Computing remez polynomial...");
p =fpminimax(sin(x), [|3,5|],[|D,D|], [-1/8; 1/8],x);
print("... done.");
theta = 2^(-16);
supnorm(p,f,d,mode,theta);
